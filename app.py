<INSERT FULL CODE HERE MANUALLY - CONTEXT WAS LOST DUE TO CODE EXECUTION RESET>